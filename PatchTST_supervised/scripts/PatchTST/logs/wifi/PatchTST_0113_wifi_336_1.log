Args in experiment:
Namespace(activation='gelu', affine=0, batch_size=1024, c_out=7, checkpoint_path=None, checkpoints='./checkpoints/', d_ff=256, d_layers=1, d_model=128, data='custom', data_path='timestamp.csv', dec_in=7, decomposition=0, devices='0', do_predict=False, draw=0, dropout=0.2, e_layers=3, enc_in=7, factor=1, fc_dropout=0.2, features='MS', freq='s', gpu=0, head_dropout=0.0, individual=0, is_training=1, kernel_size=25, label_len=48, learning_rate=0.0002, loss='mse', lradj='TST', model='PatchTST', model_id='0113_wifi_336_1', moving_avg=25, n_heads=16, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=20, pct_start=0.4, pred_len=1, random_seed=2021, revin=1, root_path='/home/test/Documents/PatchTST/dataset/0113', seq_len=336, stride=8, subtract_last=0, target='OT', test_flop=False, train_epochs=300, use_amp=False, use_gpu=True, use_hour_sin=1, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : 0113_wifi_336_1_PatchTST_custom_featureMS_seqlen336_labellen48_predlen1_patch16_stride8_d_model128_numheads16_elayers3_dlayers1_dff256_fc1_time_emb1>>>>>>>>>>>>>>>>>>>>>>>>>>
train 34003
val 4906
test 9811
Epoch: 1 cost time: 7.942053318023682
Epoch: 1, Steps: 33 | Train Loss: 1.3817292 Vali Loss: 0.9767541 Test Loss: 1.1414106
Validation loss decreased (inf --> 0.976754).  Saving model ...
Updating learning rate to 8.032913422238827e-06
Epoch: 2 cost time: 6.217014789581299
Epoch: 2, Steps: 33 | Train Loss: 1.3292412 Vali Loss: 1.2528483 Test Loss: 1.1194602
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.131631120343656e-06
Epoch: 3 cost time: 6.1928863525390625
Epoch: 3, Steps: 33 | Train Loss: 1.3282115 Vali Loss: 1.2118039 Test Loss: 1.0951589
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.296085403954392e-06
Epoch: 4 cost time: 6.20573353767395
Epoch: 4, Steps: 33 | Train Loss: 1.2453225 Vali Loss: 1.1014280 Test Loss: 1.0723537
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.526163507377877e-06
Epoch: 5 cost time: 6.2200963497161865
Epoch: 5, Steps: 33 | Train Loss: 1.2247045 Vali Loss: 1.0641582 Test Loss: 1.0522108
EarlyStopping counter: 4 out of 20
Updating learning rate to 8.821707666910615e-06
Epoch: 6 cost time: 6.181737899780273
Epoch: 6, Steps: 33 | Train Loss: 1.2127275 Vali Loss: 0.8124938 Test Loss: 1.0328516
Validation loss decreased (0.976754 --> 0.812494).  Saving model ...
Updating learning rate to 9.182515229016889e-06
Epoch: 7 cost time: 6.066596269607544
Epoch: 7, Steps: 33 | Train Loss: 1.1768124 Vali Loss: 1.1726521 Test Loss: 1.0140575
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.608338789287592e-06
Epoch: 8 cost time: 6.199804067611694
Epoch: 8, Steps: 33 | Train Loss: 1.1503319 Vali Loss: 1.1872016 Test Loss: 0.9969285
EarlyStopping counter: 2 out of 20
Updating learning rate to 1.0098886362084448e-05
Epoch: 9 cost time: 6.230663537979126
Epoch: 9, Steps: 33 | Train Loss: 1.1470249 Vali Loss: 0.9189796 Test Loss: 0.9807436
EarlyStopping counter: 3 out of 20
Updating learning rate to 1.065382158075347e-05
Epoch: 10 cost time: 6.225378036499023
Epoch: 10, Steps: 33 | Train Loss: 1.1085497 Vali Loss: 1.2912246 Test Loss: 0.9661006
EarlyStopping counter: 4 out of 20
Updating learning rate to 1.1272763928270275e-05
Epoch: 11 cost time: 6.1888628005981445
Epoch: 11, Steps: 33 | Train Loss: 1.0923595 Vali Loss: 0.9512466 Test Loss: 0.9483290
EarlyStopping counter: 5 out of 20
Updating learning rate to 1.1955288998159378e-05
Epoch: 12 cost time: 6.236468553543091
Epoch: 12, Steps: 33 | Train Loss: 1.0915442 Vali Loss: 1.0724478 Test Loss: 0.9328139
EarlyStopping counter: 6 out of 20
Updating learning rate to 1.2700928785507986e-05
Epoch: 13 cost time: 6.144428730010986
Epoch: 13, Steps: 33 | Train Loss: 1.0580708 Vali Loss: 1.0081390 Test Loss: 0.9187263
EarlyStopping counter: 7 out of 20
Updating learning rate to 1.3509172007875292e-05
Epoch: 14 cost time: 6.243882656097412
Epoch: 14, Steps: 33 | Train Loss: 1.0336826 Vali Loss: 1.1176077 Test Loss: 0.9070095
EarlyStopping counter: 8 out of 20
Updating learning rate to 1.4379464455876908e-05
Epoch: 15 cost time: 6.171194314956665
Epoch: 15, Steps: 33 | Train Loss: 1.0272828 Vali Loss: 1.2314379 Test Loss: 0.8925700
EarlyStopping counter: 9 out of 20
Updating learning rate to 1.5311209373204243e-05
Epoch: 16 cost time: 6.186318397521973
Epoch: 16, Steps: 33 | Train Loss: 1.0045926 Vali Loss: 0.8184065 Test Loss: 0.8788850
EarlyStopping counter: 10 out of 20
Updating learning rate to 1.630376786581814e-05
Epoch: 17 cost time: 6.207541227340698
Epoch: 17, Steps: 33 | Train Loss: 0.9938303 Vali Loss: 0.9699764 Test Loss: 0.8651644
EarlyStopping counter: 11 out of 20
Updating learning rate to 1.7356459340035925e-05
Epoch: 18 cost time: 6.162554740905762
Epoch: 18, Steps: 33 | Train Loss: 0.9826305 Vali Loss: 0.9501971 Test Loss: 0.8533021
EarlyStopping counter: 12 out of 20
Updating learning rate to 1.846856196921224e-05
Epoch: 19 cost time: 6.21697211265564
Epoch: 19, Steps: 33 | Train Loss: 0.9487179 Vali Loss: 1.0559267 Test Loss: 0.8426182
EarlyStopping counter: 13 out of 20
Updating learning rate to 1.9639313188692814e-05
Epoch: 20 cost time: 6.188182592391968
Epoch: 20, Steps: 33 | Train Loss: 0.9510076 Vali Loss: 1.1320248 Test Loss: 0.8320757
EarlyStopping counter: 14 out of 20
Updating learning rate to 2.086791021870213e-05
Epoch: 21 cost time: 6.202774286270142
Epoch: 21, Steps: 33 | Train Loss: 0.9467146 Vali Loss: 1.1270033 Test Loss: 0.8202553
EarlyStopping counter: 15 out of 20
Updating learning rate to 2.2153510614806665e-05
Epoch: 22 cost time: 6.190741300582886
Epoch: 22, Steps: 33 | Train Loss: 0.9392213 Vali Loss: 0.9446020 Test Loss: 0.8121434
EarlyStopping counter: 16 out of 20
Updating learning rate to 2.349523284557575e-05
Epoch: 23 cost time: 6.167583703994751
Epoch: 23, Steps: 33 | Train Loss: 0.9166300 Vali Loss: 1.0628415 Test Loss: 0.8029033
EarlyStopping counter: 17 out of 20
Updating learning rate to 2.48921568970448e-05
Epoch: 24 cost time: 6.175710201263428
Epoch: 24, Steps: 33 | Train Loss: 0.9104056 Vali Loss: 1.1318102 Test Loss: 0.7975879
EarlyStopping counter: 18 out of 20
Updating learning rate to 2.634332490356487e-05
Epoch: 25 cost time: 6.217893600463867
Epoch: 25, Steps: 33 | Train Loss: 0.9203039 Vali Loss: 0.8141412 Test Loss: 0.7919919
EarlyStopping counter: 19 out of 20
Updating learning rate to 2.7847741804608143e-05
Epoch: 26 cost time: 6.160017967224121
Epoch: 26, Steps: 33 | Train Loss: 0.9138369 Vali Loss: 1.1875018 Test Loss: 0.7849645
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : 0113_wifi_336_1_PatchTST_custom_featureMS_seqlen336_labellen48_predlen1_patch16_stride8_d_model128_numheads16_elayers3_dlayers1_dff256_fc1_time_emb1<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 9811
========================337==========================
mse:1.0328516960144043, mae:0.3964548707008362, rse:1.0459671020507812
